
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Using ChatGPT with Page Transactions &#8212; guara 0.0.12 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Asynchronous execution" href="ASYNC.html" />
    <link rel="prev" title="Welcome to guara’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-chatgpt-with-page-transactions">
<h1>Using ChatGPT with Page Transactions<a class="headerlink" href="#using-chatgpt-with-page-transactions" title="Permalink to this headline">¶</a></h1>
<p>As <cite>Page Transactions</cite> pattern is a new term. ChatGPT will not find a reference to it. But, it is not an excuse to not use the pattern. Teaching ChatGPT about the pattern is very easy and fast and the result is pretty much accurate.</p>
<ol class="arabic simple">
<li>Go to [ChatGPT](<a class="reference external" href="https://chatgpt.com/">https://chatgpt.com/</a>) page and login with your account. Create a new one if necessary.</li>
<li>Go to [Guara README.md](<a class="reference external" href="https://github.com/douglasdcm/guara/tree/main/docs/THE_PATTERN_EXPLAINED.md">https://github.com/douglasdcm/guara/tree/main/docs/THE_PATTERN_EXPLAINED.md</a>) and copy the raw content ![alt text](images/copy_raw_content.png)</li>
</ol>
<p>3. Paste the following statements in the ChatGPT prompt
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">Given</span> <span class="pre">the</span> <span class="pre">explanation</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pattern</span> <span class="pre">Page</span> <span class="pre">Transactions</span> <span class="pre">after</span> <span class="pre">the</span> <span class="pre">dots</span> <span class="pre">let</span> <span class="pre">me</span> <span class="pre">know</span> <span class="pre">what</span> <span class="pre">you</span> <span class="pre">understood</span>
<span class="pre">...</span>
<span class="pre">&lt;the</span> <span class="pre">raw</span> <span class="pre">content</span> <span class="pre">you</span> <span class="pre">copied&gt;</span>
<span class="pre">`</span></code>
4. Check it understanding and continue
5. Now that ChatGPT knows about the new pattern. Ask it to organize your code using it
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">Based</span> <span class="pre">on</span> <span class="pre">your</span> <span class="pre">understanding</span> <span class="pre">about</span> <span class="pre">the</span> <span class="pre">pattern</span> <span class="pre">Page</span> <span class="pre">Transactions</span> <span class="pre">organize</span> <span class="pre">the</span> <span class="pre">code</span> <span class="pre">after</span> <span class="pre">the</span> <span class="pre">dots</span>
<span class="pre">...</span>
<span class="pre">&lt;your</span> <span class="pre">raw</span> <span class="pre">code&gt;</span>
<span class="pre">`</span></code>
6. Check if</p>
<ul class="simple">
<li><cite>guara</cite> is part of the imports</li>
<li><cite>Application</cite> is used to orchestrate the code execution with <cite>at</cite> and <cite>asserts</cite></li>
</ul>
<ol class="arabic simple" start="7">
<li>Make necessary adjustments if necessary</li>
<li>Done! Your code is in the new pattern.</li>
</ol>
<p># Here is a practical example</p>
<p>## Raw code in Selenium</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
import random
import pathlib
from selenium import webdriver
from selenium.webdriver.common.by import By</p>
<dl class="docutils">
<dt>def test_sample_page():</dt>
<dd><p class="first">file_path = pathlib.Path(__file__).parent.resolve()
driver = webdriver.Chrome()</p>
<p>driver.get(f”<a class="reference external" href="file://">file://</a>/{file_path}/sample.html”)</p>
<p>title = driver.title
# assert title == “Web form”
assert title == “Sample page”</p>
<p>driver.implicitly_wait(0.5)</p>
<p># text_box = driver.find_element(by=By.NAME, value=”input”)
text_box = driver.find_element(by=By.ID, value=”input”)
submit_button = driver.find_element(by=By.CSS_SELECTOR, value=”button”)</p>
<p>text = [“cheese”, “selenium”, “test”, “bla”, “foo”]
text_box.send_keys(text[random.randrange(len(text))])
from_input = text_box.get_attribute(“value”)
submit_button.click()</p>
<p>message = driver.find_element(by=By.ID, value=”result”)
value = message.text
# assert value == “It workls! Selenium!”
assert value == f”It works! {from_input}!”</p>
<p class="last">driver.quit()</p>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>## It is the output of ChatGPT</p>
<p>To organize this code following the Page Transactions pattern, we need to abstract transactions (e.g., opening the page, interacting with input fields, and validating results) into reusable classes that inherit from AbstractTransaction. The test logic should then use the Application class to orchestrate these transactions.</p>
<p>Here’s the organized code:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
import random
import pathlib
from selenium import webdriver
from selenium.webdriver.common.by import By
from guara.transaction import AbstractTransaction, Application
from guara import it</p>
<p># Transaction: Open the sample page
class OpenSamplePage(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def __init__(self, driver, file_path):</dt>
<dd>super().__init__(driver)
self.file_path = file_path</dd>
<dt>def do(self, <a href="#id13"><span class="problematic" id="id14">**</span></a>kwargs):</dt>
<dd>self._driver.get(f”<a class="reference external" href="file://">file://</a>/{self.file_path}/sample.html”)
self._driver.implicitly_wait(0.5)
return self._driver.title</dd>
</dl>
</div></blockquote>
<p># Transaction: Submit text to the form
class SubmitText(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, <a href="#id15"><span class="problematic" id="id16">**</span></a>kwargs):</dt>
<dd><p class="first">text = kwargs.get(“text”, “”)
text_box = self._driver.find_element(by=By.ID, value=”input”)
submit_button = self._driver.find_element(by=By.CSS_SELECTOR, value=”button”)</p>
<p class="last">text_box.send_keys(text)
from_input = text_box.get_attribute(“value”)
submit_button.click()
return from_input</p>
</dd>
</dl>
</div></blockquote>
<p># Transaction: Validate the result message
class ValidateResult(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, <a href="#id17"><span class="problematic" id="id18">**</span></a>kwargs):</dt>
<dd>expected_text = kwargs.get(“expected_text”, “”)
message = self._driver.find_element(by=By.ID, value=”result”)
return message.text == f”It works! {expected_text}!”</dd>
</dl>
</div></blockquote>
<p># Transaction to close the application
class CloseApplication(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, screenshot_filename: str = “./captures/guara-capture”) -&gt; None:</dt>
<dd>self._driver.get_screenshot_as_file(f”{screenshot_filename}-{datetime.now()}.png”)
self._driver.quit()</dd>
</dl>
</div></blockquote>
<p># Test Case
def test_sample_page():</p>
<blockquote>
<div><p>file_path = pathlib.Path(__file__).parent.resolve()
driver = webdriver.Chrome()</p>
<p># Instantiate the Application
app = Application(driver)</p>
<p># Open the sample page and assert the title
title = app.at(OpenSamplePage, file_path=file_path).result
app.asserts(it.IsEqualTo, “Sample page”)</p>
<p># Submit text and validate the result
text_choices = [“cheese”, “selenium”, “test”, “bla”, “foo”]
selected_text = random.choice(text_choices)</p>
<p>app.at(SubmitText, text=selected_text)
app.at(ValidateResult, expected_text=selected_text).asserts(it.IsTrue)</p>
<p># Close the application
app.at(CloseApplication)</p>
</div></blockquote>
<p><a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a></p>
<p>Explanation:</p>
<dl class="docutils">
<dt>Transactions:</dt>
<dd>OpenSamplePage: Handles the logic to open the web page and optionally returns the page title.
SubmitText: Interacts with the input field and submits the form, returning the entered text.
ValidateResult: Validates that the result message matches the expected format.
CloseApplication: Closes the application</dd>
<dt>Application:</dt>
<dd>Orchestrates the transactions using the at method and applies assertions using the asserts method.</dd>
<dt>Test Flow:</dt>
<dd>The test script uses Application to execute transactions in a logical sequence.
Assertions are modular, readable, and reusable.</dd>
<dt>Reusability:</dt>
<dd>The transaction classes are reusable for other tests involving similar interactions. This modular approach reduces duplication and enhances maintainability.</dd>
</dl>
<p>Let me know if you’d like further adjustments!</p>
<p>## Make necessary adjustments</p>
<p>Notice the class <cite>OpenSamplePage</cite> has the parameter <cite>file_path</cite> with is not following the functional usage of the pattern and the assertion <cite>it.IsTrue</cite> does not exist in Guara core (yet). The new assertion introduced by the AI was a good induction.</p>
<p>It is still possible to use ChatGPT to fix the issues. For example:</p>
<p><a href="#id23"><span class="problematic" id="id24">``</span></a>`
The code has some inconsistencies listed after the dots. Based on the list, give corrections in the code and outputs it to me
….
- The transaction constructors does not allow other parameters than the <cite>driver</cite>. Any necessary parameters should be placed in the ‘do’ method
- The module ‘gura.it’ has no function ‘IsTrue’. Check the explanation after the slashes to know how to build a new custom assertion ‘IsTrue’ and replace ‘it.IsTrue’ by ‘IsTrue’</p>
<blockquote>
<div></div></blockquote>
<p># Got from <a class="reference external" href="https://github.com/douglasdcm/guara/blob/main/docs/TUTORIAL.md#extending-assertions">https://github.com/douglasdcm/guara/blob/main/docs/TUTORIAL.md#extending-assertions</a></p>
<p>The strategies to assert the result can e extended by inheriting from IAssertion as following:</p>
<p># The code is the same of the previous session.
# The unnecessary details were not duplicated
# import IAssertion
from guara.transaction import Application, IAssertion</p>
<p># Implements a new assertion to check variations of the expected value
class IsEqualToVariationsOf(IAssertion):</p>
<blockquote>
<div><dl class="docutils">
<dt>def __init__(self):</dt>
<dd>super().__init__()</dd>
<dt>def asserts(self, actual, expected):</dt>
<dd><dl class="first docutils">
<dt>if actual.lower() == expected.lower():</dt>
<dd>return True</dd>
</dl>
<p class="last">raises AssertionError</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>def test_google_search(setup_app):</dt>
<dd><p class="first">app = setup_app</p>
<p class="last"># The new assertion is used to check variations of ‘All’, like ‘aLL’ or ‘ALL’
app.at(home.Search, text=”guara”).asserts(IsEqualToVariationsOf, “All”)</p>
</dd>
</dl>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a></p>
<p>### The output</p>
<p>Here is the corrected and updated code based on the feedback:
Updates:</p>
<p>Transaction Constructors: Now accept only the driver parameter. Any additional parameters are passed to the do method.
Custom Assertion (IsTrue): A new custom assertion class is implemented, inheriting from IAssertion. This replaces the invalid it.IsTrue.</p>
<p>Corrected Code:</p>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a>python
import random
import pathlib
from selenium import webdriver
from selenium.webdriver.common.by import By
from guara.transaction import AbstractTransaction, Application, IAssertion
from guara import it</p>
<p># Custom Assertion: Checks if the actual value is True
class IsTrue(IAssertion):</p>
<blockquote>
<div><dl class="docutils">
<dt>def __init__(self):</dt>
<dd>super().__init__()</dd>
<dt>def asserts(self, actual, expected=None):</dt>
<dd><dl class="first last docutils">
<dt>if actual is not True:</dt>
<dd>raise AssertionError(f”Expected True but got {actual}”)</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p># Transaction: Open the sample page
class OpenSamplePage(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, <a href="#id33"><span class="problematic" id="id34">**</span></a>kwargs):</dt>
<dd>file_path = kwargs.get(“file_path”)
self._driver.get(f”<a class="reference external" href="file://">file://</a>/{file_path}/sample.html”)
self._driver.implicitly_wait(0.5)
return self._driver.title</dd>
</dl>
</div></blockquote>
<p># Transaction: Submit text to the form
class SubmitText(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, <a href="#id35"><span class="problematic" id="id36">**</span></a>kwargs):</dt>
<dd><p class="first">text = kwargs.get(“text”, “”)
text_box = self._driver.find_element(by=By.ID, value=”input”)
submit_button = self._driver.find_element(by=By.CSS_SELECTOR, value=”button”)</p>
<p class="last">text_box.send_keys(text)
from_input = text_box.get_attribute(“value”)
submit_button.click()
return from_input</p>
</dd>
</dl>
</div></blockquote>
<p># Transaction: Validate the result message
class ValidateResult(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, <a href="#id37"><span class="problematic" id="id38">**</span></a>kwargs):</dt>
<dd>expected_text = kwargs.get(“expected_text”, “”)
message = self._driver.find_element(by=By.ID, value=”result”)
actual_text = message.text
return actual_text == f”It works! {expected_text}!”</dd>
</dl>
</div></blockquote>
<p># Transaction to close the application
class CloseApplication(AbstractTransaction):</p>
<blockquote>
<div><dl class="docutils">
<dt>def do(self, screenshot_filename: str = “./captures/guara-capture”) -&gt; None:</dt>
<dd>self._driver.get_screenshot_as_file(f”{screenshot_filename}-{datetime.now()}.png”)
self._driver.quit()</dd>
</dl>
</div></blockquote>
<p># Test Case
def test_sample_page():</p>
<blockquote>
<div><p>file_path = pathlib.Path(__file__).parent.resolve()
driver = webdriver.Chrome()</p>
<p># Instantiate the Application
app = Application(driver)</p>
<p># Open the sample page and assert the title
title = app.at(OpenSamplePage, file_path=str(file_path)).result
app.asserts(it.IsEqualTo, “Sample page”)</p>
<p># Submit text and validate the result
text_choices = [“cheese”, “selenium”, “test”, “bla”, “foo”]
selected_text = random.choice(text_choices)</p>
<p>app.at(SubmitText, text=selected_text)
result = app.at(ValidateResult, expected_text=selected_text).result</p>
<p># Use the custom assertion to validate that the result is True
app.asserts(IsTrue, result)</p>
<p># Close the application
app.at(CloseApplication)</p>
</div></blockquote>
<p><a href="#id39"><span class="problematic" id="id40">``</span></a><a href="#id41"><span class="problematic" id="id42">`</span></a></p>
<p># Conclusion
The code needs some polishiment, like the <cite>title</cite> variable is never used, the occurrences of <cite>app.asserts</cite> can be suppressed to a single line like <cite>app.at(OpenSamplePage, file_path=str(file_path)).asserts(it.IsEqualTo, “Sample page”)</cite> and the transaction <cite>ValidateResult</cite> does not seems to be a valid transaction the user does in the application, so this code could be merged with <cite>SubmitText</cite> to reduce the verbosity. However, despite these embellishments, the code works perfectly.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">guara</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using ChatGPT with Page Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ASYNC.html">Asynchronous execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="DRY_RUN.html">Dry run configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="LOGS.html">Logs in execution</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to guara’s documentation!</a></li>
      <li>Next: <a href="ASYNC.html" title="next chapter">Asynchronous execution</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2025, Douglas Cardoso.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/CHATGPT_ASSISTANCE.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>